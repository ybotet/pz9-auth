 # pz9-auth

Минимальный сервис аутентификации с регистрацией и входом пользователей, реализованный на Go с использованием bcrypt для безопасного хранения паролей.

<b>Структура проекта</b>
<br>
<img src="screen/Снимок экрана 2025-11-18 232355.png">


Функциональность
    POST /auth/register - регистрация нового пользователя.
    POST /auth/login - аутентификация пользователя.
    Безопасное хэширование паролей с использованием bcrypt.
    Валидация входных данных.
    Работа с PostgreSQL через GORM.

Установка и запуск

1. Клонирование и инициализация проекта:

```bash
mkdir pz9-auth && cd pz9-auth
go mod init example.com/pz9-auth
```

2. Установка зависимостей:

```bash

go get github.com/go-chi/chi/v5
go get gorm.io/gorm gorm.io/driver/postgres
go get golang.org/x/crypto/bcrypt
```

3. Настройка переменных окружения:
```bash
# Windows PowerShell
setx DB_DSN "postgres://user:pass@localhost:5432/pz9?sslmode=disable"
setx BCRYPT_COST "12"
setx APP_ADDR ":8080"

# macOS/Linux
export DB_DSN="postgres://user:pass@localhost:5432/pz9?sslmode=disable"
export BCRYPT_COST=12
export APP_ADDR=":8080"
```

4. Запуск приложения:
```bash

go run cmd/api/main.go
```

<img src="screen/Снимок экрана 2025-11-18 231113.png">

<img src="screen/Снимок экрана 2025-11-18 231451.png">

<img src="screen/Снимок экрана 2025-11-18 231240.png">

<img src="screen/Снимок экрана 2025-11-18 231310.png">

<img src="screen/Снимок экрана 2025-11-18 232017.png">

Контрольные вопросы

. В чём разница между хранением пароля и хранением его хэша? Зачем соль? Почему bcrypt, а не SHA-256?

Пароль в открытом виде можно прочитать, а хэш - нет. Хэш это однонаправленное преобразование. Соль добавляет случайность чтобы одинаковые пароли имели разные хэши. bcrypt медленнее чем SHA-256 и специально создан для паролей, что защищает от быстрого перебора.

2. Что произойдёт при снижении/повышении cost у bcrypt? Как подобрать значение?

При увеличении cost хэширование становится медленнее и безопаснее. При уменьшении - быстрее но менее безопасно. Обычно используют 10-14. Для учебных проектов 12 нормально.

3. Какие статусы и ответы должны возвращать POST /auth/register и POST /auth/login в типичных сценариях?

Register: 201 при успехе, 409 если email занят, 400 при ошибках валидации.
Login: 200 при успехе, 401 при неверных данных, 400 при ошибках ввода.

4. Какие риски несут подробные сообщения об ошибках при логине?

Злоумышленник может узнать какие email есть в системе. Поэтому всегда пишем "неверный логин или пароль" даже если email не найден.

5. Почему в этом ПЗ не выдаём токен, и что изменится в ПЗ10 (JWT)?

В этом занятии мы только проверяем пароль. В ПЗ10 добавим JWT токены для доступа к защищенным ресурсам после успешного логина.
